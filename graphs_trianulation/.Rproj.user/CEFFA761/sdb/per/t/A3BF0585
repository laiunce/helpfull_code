{
    "collab_server" : "",
    "contents" : "\n\n#install.packages(\"FactoMineR\")\nlibrary(FactoMineR)\n\n#aplicacion nativa vs sistema operativo\ntabla1<-table(data_categoricas$sistema_operativo_mobile,data_categoricas$client_id) \nmodelo1<-CA(tabla1)\n\n\ntabla2<-table(data_categoricas$provider_id ,data_categoricas$client_id) \nmodelo2<-CA(tabla2)\n\ntabla3<-table(data_categoricas$provider_id ,data_categoricas$sistema_operativo_mobile) \nmodelo3<-CA(tabla3)\n\n\n## HAP \n\ntabla_hap_tc_user <- table(data_categoricas$has_approved_payment_tc ,data_categoricas$has_approved_payment_user)\ntabla_hap_tc_user_df <- data.frame(tabla_hap_tc_user)\n\n#uno las posibilidades\n#data.frame(paste('hap_tc(', tabla_hap_tc_user_df$Var1,')_hap_us(',tabla_hap_tc_user_df$Var2,')', sep = \"\") )\n\n\ndata_categoricas_haps<-ifelse(data_categoricas$has_approved_payment_tc=='Y' & data_categoricas$has_approved_payment_user == 'Y','tc(Y)us(Y)',\n                              ifelse(data_categoricas$has_approved_payment_tc=='Y' & data_categoricas$has_approved_payment_user == 'N','tc(Y)us(N)',\n                                     ifelse(data_categoricas$has_approved_payment_tc=='N' & data_categoricas$has_approved_payment_user == 'Y','tc(N)us(Y)',\n                                            ifelse(data_categoricas$has_approved_payment_tc=='N' & data_categoricas$has_approved_payment_user == 'N','tc(N)us(N)',\n                                                   ''\n                                            )\n                                     )\n                              )\n)\n\n\ntabla<-table(data_categoricas_haps, data_categoricas$sistema_operativo_mobile) \nmodelo<-CA(tabla)\n\nmodelo$row\nmodelo$col\nmodelo$eig\n\ntabla<-table(data_categoricas_haps, data_categoricas$client_id) \nmodelo<-CA(tabla)\n\n\n\n#hacer por montos\n\ntabla4<-table(data$op_dol_amount_range ,data_categoricas$sistema_operativo_mobile) \nmodelo4<-CA(tabla4)\n\ntabla5<-table(data$op_dol_amount_range ,data$sender_antiguedad_range) \nmodelo5<-CA(tabla5)\n\ntabla6<-table(data$seller_antiguedad_range ,data$sender_antiguedad_range) \nmodelo6<-CA(tabla6)\n\n#los usuarioes nuevos te operan por mobile\ntabla7<-table(data_categoricas$sistema_operativo_mobile ,data$sender_antiguedad_range) \nmodelo7<-CA(tabla7)\n\n#los usuarioes nuevos te operan por client_id\ntabla7<-table(data_categoricas$client_id ,data$sender_antiguedad_range) \nmodelo7<-CA(tabla7)\n\n\ntabla6<-table(data$seller_puntos_range ,data$sender_puntos_range) \nmodelo6<-CA(tabla6)\n\n\n\n### con varias variables usando solo las de HAP\n\n\n\nlibrary(FactoMineR)\nlibrary(ca)\nstr(data_categoricas)\nlibrary(ggplot2)\n#saco nombre de variables\n\n#data_cat <- data_categoricas[,c(\"sistema_operativo_mobile\",\"profile_id\",\"provider_id\",\"client_id\",\"has_approved_device\",\"has_approved_payment_document\",\"has_approved_payment_user\",\"has_approved_payment_tc\")]\n\ndata_cat <- data_categoricas[,c(\"has_approved_device\",\"has_approved_payment_document\",\"has_approved_payment_user\",\"has_approved_payment_tc\")]\ncolnames(data_cat)<- c(\"hap_device\",\"hap_pay_doc\",\"hap_pay_user\",\"hap_pay_tc\")\n\ncats_cat = apply(data_cat, 2, function(x) nlevels(as.factor(x)))\ncats_cat\n\n\n\nmca1_cat = MCA(data_cat, graph = FALSE)\nprint(mca1_cat)\n\nmca1_cat$var$contrib\nsummary(mca1_cat)\n\nmca1_cat_vars_df = data.frame(mca1_cat$var$coord, Variable = rep(names(cats_cat), \n                                                                 cats_cat))\nmca1_cat_obs_df = data.frame(mca1_cat$ind$coord)\n\n\n\n# plot of variable categories\nggplot(data = mca1_cat_vars_df, aes(x = Dim.1, y = Dim.2, label = rownames(mca1_cat_vars_df))) + \n  geom_hline(yintercept = 0, colour = \"gray70\") + geom_vline(xintercept = 0, \n                                                             colour = \"gray70\") + geom_text(aes(colour = Variable)) + ggtitle(\"MCA plot of variables using R package FactoMineR\")\n\nsummary(mca1_cat)\n\n# MCA plot of observations and categories\nggplot(data = mca1_cat_obs_df, aes(x = Dim.1, y = Dim.2)) + geom_hline(yintercept = 0, \n                                                                       colour = \"gray70\") + geom_vline(xintercept = 0, colour = \"gray70\") + geom_point(colour = \"gray50\", \n                                                                                                                                                       alpha = 0.7) + geom_density2d(colour = \"gray80\") + geom_text(data = mca1_cat_vars_df, \n                                                                                                                                                                                                                    aes(x = Dim.1, y = Dim.2, label = rownames(mca1_cat_vars_df), colour = Variable)) + \n  ggtitle(\"MCA plot of variables using R package FactoMineR\") + scale_colour_discrete(name = \"Variable\")\n\n\n#####\n#hago con todas las variables discretizadas del preprocess\n\n\nlibrary(FactoMineR)\nlibrary(ca)\n\n\n#saco nombre de variables\n\n#data_cat <- data_categoricas[,c(\"sistema_operativo_mobile\",\"profile_id\",\"provider_id\",\"client_id\",\"has_approved_device\",\"has_approved_payment_document\",\"has_approved_payment_user\",\"has_approved_payment_tc\")]\n\ndata_cat <- data[,c(\"op_dol_amount_range\",\"sender_antiguedad_range\",\"seller_antiguedad_range\")]\n#colnames(data_cat)<- c(\"hap_device\",\"hap_pay_doc\",\"hap_pay_user\",\"hap_pay_tc\")\nstr(data_cat)\n\ncats_cat = apply(data_cat, 2, function(x) nlevels(as.factor(x)))\ncats_cat\n\nmca1_cat = MCA(data_cat, graph = FALSE)\nmca1_cat$eig\n\nmca1_cat_vars_df = data.frame(mca1_cat$var$coord, Variable = rep(names(cats_cat), \n                                                                 cats_cat))\nmca1_cat_obs_df = data.frame(mca1_cat$ind$coord)\n\n\n\n# plot of variable categories\nggplot(data = mca1_cat_vars_df, aes(x = Dim.1, y = Dim.2, label = rownames(mca1_cat_vars_df))) + \n  geom_hline(yintercept = 0, colour = \"gray70\") + geom_vline(xintercept = 0, \n                                                             colour = \"gray70\") + geom_text(aes(colour = Variable)) + ggtitle(\"MCA plot of variables using R package FactoMineR\")\n\n\n\nsummary(mca1_cat)\n\n# MCA plot of observations and categories\nggplot(data = mca1_cat_obs_df, aes(x = Dim.1, y = Dim.2)) + geom_hline(yintercept = 0, \n                                                                       colour = \"gray70\") + geom_vline(xintercept = 0, colour = \"gray70\") + geom_point(colour = \"gray50\", \n                                                                                                                                                       alpha = 0.7) + geom_density2d(colour = \"gray80\") + geom_text(data = mca1_cat_vars_df, \n                                                                                                                                                                                                                    aes(x = Dim.1, y = Dim.2, label = rownames(mca1_cat_vars_df), colour = Variable)) + \n  ggtitle(\"MCA plot of variables using R package FactoMineR\") + scale_colour_discrete(name = \"Variable\")\n\n\n\n#####\n#hago con antiguedad de items y dolar\n\n\nlibrary(FactoMineR)\nlibrary(ca)\n\n\n#saco nombre de variables\n\n#data_cat <- data_categoricas[,c(\"sistema_operativo_mobile\",\"profile_id\",\"provider_id\",\"client_id\",\"has_approved_device\",\"has_approved_payment_document\",\"has_approved_payment_user\",\"has_approved_payment_tc\")]\n\ndata_cat <- data[,c(\"sender_puntos_range\",\"seller_puntos_range\")]\n#colnames(data_cat)<- c(\"hap_device\",\"hap_pay_doc\",\"hap_pay_user\",\"hap_pay_tc\")\nstr(data_cat)\n\ncats_cat = apply(data_cat, 2, function(x) nlevels(as.factor(x)))\ncats_cat\n\nmca1_cat = MCA(data_cat, graph = FALSE)\n\nmca1_cat$eig\n\nmca1_cat_vars_df = data.frame(mca1_cat$var$coord, Variable = rep(names(cats_cat), \n                                                                 cats_cat))\nmca1_cat_obs_df = data.frame(mca1_cat$ind$coord)\n\n\n\n# plot of variable categories\nggplot(data = mca1_cat_vars_df, aes(x = Dim.1, y = Dim.2, label = rownames(mca1_cat_vars_df))) + \n  geom_hline(yintercept = 0, colour = \"gray70\") + geom_vline(xintercept = 0, \n                                                             colour = \"gray70\") + geom_text(aes(colour = Variable)) + ggtitle(\"MCA plot of variables using R package FactoMineR\")\n\n\n\n\n# MCA plot of observations and categories\nggplot(data = mca1_cat_obs_df, aes(x = Dim.1, y = Dim.2)) + geom_hline(yintercept = 0, \n                                                                       colour = \"gray70\") + geom_vline(xintercept = 0, colour = \"gray70\") + geom_point(colour = \"gray50\", \n                                                                                                                                                       alpha = 0.7) + geom_density2d(colour = \"gray80\") + geom_text(data = mca1_cat_vars_df, \n                                                                                                                                                                                                                    aes(x = Dim.1, y = Dim.2, label = rownames(mca1_cat_vars_df), colour = Variable)) + \n  ggtitle(\"MCA plot of variables using R package FactoMineR\") + scale_colour_discrete(name = \"Variable\")\n\n",
    "created" : 1522106048103.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1309784648",
    "id" : "A3BF0585",
    "lastKnownWriteTime" : 1495239382,
    "last_content_update" : 1495239382,
    "path" : "~/Google Drive/Trabajo/4-Facu/1ro/1 Q/AID/TP Final AID/Proyecto/analisis correspondencia.R",
    "project_path" : null,
    "properties" : {
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}